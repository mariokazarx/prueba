<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core">

    <body>

        <ui:composition template="./../plantilla.xhtml">

            <ui:define name="content">
                <h:form id="frmListaCursos">
                    <p:commandButton value="Nuevo Curso" icon="ui-icon-document" actionListener="#{mbvCurso.newCurso}">
                        <p:ajax event="dialogReturn" listener="#{mbvCurso.closeDialog}" update="frmListaCursos" />
                    </p:commandButton>
                    <p:growl id="mensajeGeneral" showDetail="true" sticky="false" />
                    <p:dataTable id="tablaListaCurso" var="curso" value="#{mbvCurso.cursos}" paginator="true" rows="10" selection="#{mbvCurso.curso}" selectionMode="single" lazy="true" rowKey="#{curso.cicloId}" >
                        <p:ajax event="rowSelect" update=":frmListaCursos:panelDetalleCurso" oncomplete="PF('dialogoDetalleCurso').show()"/>
                        <f:facet name="header">
                            CUrsos
                        </f:facet>
                        <p:column headerText="Nombre" filterBy="nombre">
                            <h:outputText value="#{curso.nombre}"/>
                        </p:column>
                        <p:column headerText="Ciclo" filterBy="ciclo">
                            <h:outputText value="#{curso.cicloId.numero}"/>
                        </p:column>
                        <p:column headerText="AÃ±o Lectivo" filterBy="max">
                            <h:outputText value="#{curso.anlectivoId.anio}"/>
                        </p:column>
                        <p:column headerText="Numero de Estudiantes" filterBy="min">
                            <h:outputText value="#{curso.numeroestudiantes}"/>
                        </p:column>
                        <p:column>
                            <p:commandButton value="Editar" icon="ui-icon-pencil" actionListener="#{mbvCurso.cargarCurso(curso.cursoId)}"/>
                        </p:column>
                    </p:dataTable>

                    <p:dialog header="Detalle del Curso" widgetVar="dialogoDetalleCurso" modal="true" appendTo="@(body)" showEffect="clip" hideEffect="clip" resizable="false">
                        <p:outputPanel id="panelDetalleCurso">
                            <p:panelGrid columns="2">
                                <p:outputLabel value="Id"/>
                                <h:outputText value="#{mbvCurso.curso.cursoId}"/>
                                <p:outputLabel value="Nombre"/>
                                <h:outputText value="#{mbvCurso.curso.nombre}"/>
                                <p:outputLabel value="Curso"/>
                                <h:outputText value="#{mbvCurso.curso.cicloId.numero}"/>
                                <p:outputLabel value="Ano Lectivo"/>
                                <h:outputText value="#{mbvCurso.curso.anlectivoId.anio}"/>
                                <p:outputLabel value="Numero Estudiantes"/>
                                <h:outputText value="#{mbvCurso.curso.numeroestudiantes}"/>
                            </p:panelGrid>
                        </p:outputPanel>
                    </p:dialog>                   
                </h:form>
                
                <p:dialog header="Datos Del Curso" widgetVar="dialogoEditarCurso" modal="true" appendTo="@(body)" showEffect="clip" hideEffect="clip">
                    <h:form id="frmEditarCurso">
                        <p:outputPanel id="panelEditarCurso" >
                             <h:panelGrid columns="3">
                                <p:outputLabel for="txtNombre" value="Nombre: " />
                                <p:inputText id="txtNombre" value="#{mbvCurso.curso.nombre}" >
                                    <f:validator validatorId="validatorVacio"/>
                                </p:inputText>
                                <p:message for="txtNombre"/>
                                <p:outputLabel for="txtDescripcion" value="Descrpcion: " />
                                <p:inputTextarea id="txtDescripcion" value="#{mbvcriterioevaluacion.criterioeval.descripcion}" autoResize="false" rows="5" cols="22" />
                                <p:message for="txtDescripcion"/>
                                <p:outputLabel for="stlCriterio" value="Criterio de aprobacion:" />
                                <p:selectOneMenu id="stlCriterio" value="#{mbvcriterioevaluacion.fcriterioselected.formacriterioevaluacionId}">
                                    <f:selectItems value="#{mbvcriterioevaluacion.fcriterios}" var="fcriterio" itemLabel="#{fcriterio.nombre}" itemValue="#{fcriterio.formacriterioevaluacionId}"/>
                                </p:selectOneMenu>
                                <p:message for="stlCriterio"/>
                                <p:outputLabel for="txtMin" value="Minimo para aprobar:" />
                                <p:inputText id="txtMin" value="#{mbvcriterioevaluacion.criterioeval.minaprob}" />
                                <p:message for="txtMin"/>
                                <h:panelGroup></h:panelGroup>
                                <p:commandButton value="Registrar Escala" actionListener="#{mbvcriterioevaluacion.actualizar}" ajax="true" update=":frmListaCursos" />
                            </h:panelGrid> 
                        </p:outputPanel>
                    </h:form>
                </p:dialog>
            </ui:define>

        </ui:composition>

    </body>
</html>
